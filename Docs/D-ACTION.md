# ๐งฉ Laravel Domain Action Generator (`make:d-action`)


ุฏุณุชูุฑ: `php artisan make:d-action {Name} --domain={Domain} [options]`

ุงู ุณูุฏ ฺฉุงูู ู ฺฉุงุฑุจุฑุฏ ุชูุถุญ ูโุฏูุฏ ฺฉู ุงู ุฏุณุชูุฑ ฺู ูโุณุงุฒุฏุ ฺู ุขูพุดูโูุง ุฏุงุฑุฏุ ฺุทูุฑ ุฏุฑ ุณุงุฎุชุงุฑ DOD (Domain-Oriented Design) ฺฉุงุฑ ูโฺฉูุฏ ู ฺู ูฺฉุงุช ุจุฑุง ุงุณุชูุงุฏู ู ุชูุณุนูู ุขู ุจุงุฏ ุฑุนุงุช ุดูุฏ.
---

## ฺุฑุง ุงู ุฏุณุชูุฑ ูุฌูุฏ ุฏุงุฑุฏุ
ูุฏู: ุณุฑุน ู ุณุงุฒฺฏุงุฑ ุจุง ุงูฺฏู DODุ ฺฉูุงุณโูุง ยซActionยป ุฑุง ุจุณุงุฒุฏ ฺฉู ููุทู ฺฉุณุจโูฺฉุงุฑ (use-case) ุฑุง ูฺฏู ุฏุงุฑูุฏ. Action ุฌุง ููุงุณุจ ุงุณุช ุจุฑุง ูุฑุงุฑ ุฏุงุฏู ููุทู ุชุฌุงุฑ ุจูโุทูุฑ ฺฉู ูุงุจู ุชุณุชุ ูุงุจู ูุฑุงุฎูุงู ุงุฒ ฺฉูุชุฑูุฑ/Job/CLI ู ูุงุจู ูฺฏูุฏุงุฑ ุจุงุดุฏ. ุงู ุฏุณุชูุฑ ฺฉูฺฉ ูโฺฉูุฏ ฺฉู ุชู ุงุฒ ุณุงุฎุชุงุฑ ฺฉุณุงู ุงุณุชูุงุฏู ฺฉูุฏ ู ููุงุฑุฏ ุชฺฉุฑุงุฑ ุฑุง ุฎูุฏฺฉุงุฑ ุจุณุงุฒุฏ (ู ูู ุจุดุชุฑ).

---

## ูุญู ูุฑุงุฑฺฏุฑ ูุงู ู ูุงูฺฏุฐุงุฑ
- ูุณุฑ ุชููุฏโุดุฏู: `app/Domain/{Domain}/Actions/{Name}.php`
-  ูพุดููุงุฏุงุช ุจุฑุง ุงุณูโฺฏุฐุงุฑ: ูุนูโูุญูุฑ ู ุฎูุงุตู โ `CreatePost`, `ImportUsers`, `PublishArticle` ุง ุจุง ูพุณููุฏ `Action` ุงฺฏุฑ ุชู ุฏูุณุช ุฏุงุฑุฏ (`CreatePostAction`). ฺฉุฏ ูุนู ุงุฎุชุงุฑ ูุงูโฺฏุฐุงุฑ ุฑุง ุจู ุชูุณุนูโุฏููุฏู ูโุฏูุฏ (ุนุฏู ุงุฌุจุงุฑโุณุงุฒ ูพุณููุฏ Action).

---

## ุฎุฑูุฌโูุง ุงุตู ุฏุณุชูุฑ
- ฺฉูุงุณ Action : `app/Domain/{Domain}/Actions/{Name}.php`
- ูุญุชูุง: importูุง ูุงุฒู (model/request) ู ุงุณฺฉูุช ูุชุฏ (`__invoke` ุง `handle` ุง ูุงู ุฏูุฎูุงู).

---

## ุขูพุดูโูุง (ฺฉูุชุงู ู ุฏูู)

| Option | Description(Fa) | Description(En) |
|--------|--------------|----------|
| `--domain=` | **(Required)**  ูุงู ุฏุงูููุ ูพูุดู `app/Domain/{Domain}` ุจุงุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ. | Domain name (app/Domain/{Domain}) |
| `-i, --invokable` |  ฺฉูุงุณ invokable ุจุง ูุชุฏ `__invoke` ุจุณุงุฒ. | `Create an invokable action (use __invoke)` |
| `--model=Model` |  ูุฏู ูุฑุชุจุท (ูุจูู ูโฺฉูุฏ FQCN ุง ุงุณู ฺฉูุชุงู). ุงุณู ฺฉูุชุงู ุจู `App\Domain\{Domain}\Models\{Model}` ุชุจุฏู ูโุดูุฏ. | Optional model FQCN or short name to import and type-hint |
| `--request=NAME,auto` |  ุนูู import ู type-hint ูุฑูโุฑฺฉูุฆุณุช. ุงฺฏุฑ `auto` ุจุงุดุฏุ `Store{Base}Request` ุจุฑุง actionูุง create inferred ูโุดูุฏ. | Optional FormRequest name or 'auto' to infer Store{Base}Request |
| `--force` | ุจุงุฒููุณ ูุงู ุฏุฑ ุตูุฑุช ูุฌูุฏ. | Overwrite the model if it already exists. |

---

## ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ (ุฏุณุชูุฑูุง)
```bash
# 1) Action ูพุงู (non-invokable, handle)
php artisan make:d-action CreatePost --domain=Blog

# 2) Invokable ุจุง request ู model ู ุชุณุช
php artisan make:d-action CreatePost --domain=Blog --invokable --model=Post --request=auto 

# 3) ูุชุฏ ุณูุงุฑุด ู queued
php artisan make:d-action ImportUsers --domain=Admin --method=execute 

# 4) ุจุงุฒููุณ ูุงู
php artisan make:d-action CreatePost --domain=Blog --force
```

---

## ุฌุฒุฆุงุช ุชููุฏ ฺฉุฏ (ฺู ฺุฒ ุฏุงุฎู ฺฉูุงุณ ูุฑุงุฑ ูโฺฏุฑุฏ)
- ุจุฎุด importูุง: ุงฺฏุฑ `--model` ุง `--request` ุฏุงุฏู ุดุฏู ุจุงุดูุฏุ `use` ูุฑุจูุทู ุจู ุจุงูุง ูุงู ุงุถุงูู ูโุดูุฏ (unique).
- ุจุฎุด ูุชุฏ: ุงฺฏุฑ `--invokable`ุ `public function __invoke(RequestOrModel $param)` ุงุฌุงุฏ ูโุดูุฏุ ุฏุฑ ุบุฑ ุงูโุตูุฑุช ูุชุฏ `public function handle(...)` .
- ุจุฎุด body: ุงุณฺฉูุช ูุชู ุจุง ุชูุถุญุงุช ุฏุงุฎู (commented examples) ุจุฑุง ุชุจุฏู ุฏุงุฏูุ ุงุณุชูุงุฏู ุงุฒ ูุฏูุ ู return ููุฏุงุฑ ููุดุชู ูโุดูุฏ โ ุชูุณุนูโุฏููุฏู ุฑุงุจุท ููุง ุฑุง ูพุฑ ูโฺฉูุฏ.

---

## ููุงููฺฏ ุจุง ุจูู ุงุฌุฒุง ุฏุฑ ุณุงุฎุชุงุฑ DOD (ุนูู ู ุดูุงู)
- ุชุนุงูู ุจุง **Controller**: ฺฉูุชุฑูุฑ ุจุงุฏ thin ุจุงุดุฏุ ูุธููู ุขู: ุฏุฑุงูุช `FormRequest`ุ ุชุจุฏู ุจู DTO (ุง ุงุฑุณุงู ูุณุชูู)ุ authorize ุจุง Policy ู ูุฑุงุฎูุงู Action. ูุซุงู:
```php
public function store(StorePostRequest $request, CreatePost $action)
{
    $this->authorize('create', Post::class);
    $post = $action($request);
    return new PostResource($post);
}
```
- ุชุนุงูู ุจุง **Request**: ุงุนุชุจุงุฑุณูุฌ ุฏุฑ FormRequest ุงูุฌุงู ูโุดูุฏ. Action ูุจุงุฏ ุงุนุชุจุงุฑุณูุฌ ฺฉูุฏ (ูุฑูุฏ ุจุงุฏ ุขูุงุฏู ุจุงุดุฏ). ุฏุฑ ุตูุฑุช ุงุณุชูุงุฏู ุงุฒ `--request=auto`ุ ูุงู ูพุดููุงุฏ ุณุงุฎุชู ุง ุงุณุชูุงุฏู ูโุดูุฏ ูู ูุงู request ุณุงุฎุชู ููโุดูุฏ โ ุงู ููุทู ูุงุจู ุชูุณุนู ุงุณุช.
- ุชุนุงูู ุจุง **Model**: ุงฺฉุดู ูุณุชููุงู ุจุง ูุฏู ฺฉุงุฑ ูโฺฉูุฏ ุง repository ุฑุง ุชุฒุฑู ูโฺฏุฑุฏ (ุจูุชุฑ). ุงฺฏุฑ `--model` ุจู ุตูุฑุช ฺฉูุชุงู ุฏุงุฏู ุดูุฏุ command ุชููุง import ุฑุง ุงุถุงูู ูโฺฉูุฏ โ ูุฌูุฏ ูุฒฺฉ ูุงู ูุฏู ุจุฑุฑุณ ู ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุชููุง ูุดุฏุงุฑ ุฏุงุฏู ูโุดูุฏ.
- ุชุนุงูู ุจุง **Policy**: ุนูู authorization ูุนูููุง ุฏุฑ Controller ุงูุฌุงู ูโุดูุฏ. ุงฺฏุฑ Action ุฏุฑ CLI/Job ุงุณุชูุงุฏู ูโุดูุฏ ู ูุงุฒ ุจู authorization ุฏุงุฑุฏุ ุจูุชุฑ ุงุณุช ุฏุงุฎู Action ูุฒ Authorization ุง ูพุงุฑุงูุชุฑ Actor ูุฑุงุฑ ฺฏุฑุฏ โ ุชุตูู ฺฏุฑ ุจุฑ ุนูุฏู ุชู ุดูุง ุงุณุช.
- ุชุนุงูู ุจุง **Route**: ุงู ููุฑุฏ ูุนูููุง ุจู Controller ุงุดุงุฑู ุฏุงุฑุฏุ ูโุชูุงู ูุณุชูู ุจู Action invokable ูู ุงุดุงุฑู ฺฉุฑุฏ:
```php
Route::post('posts', CreatePost::class);
```

## ููุงุฑุฏ ฺฉู ุงูุงู **ุงูุฌุงู ููโุดูุฏ** ูู ูโุชูุงู ุงุถุงูู ฺฉุฑุฏ (ูพุดููุงุฏุงุช ุขุช ุจุฑุง ุดูุง)
- ุฎูุฏฺฉุงุฑ ุณุงุฎุชู FormRequest ููุช `--request=auto` ุงูุชุฎุงุจ ุดูุฏ (ุงูุงู ููุท ูุงู ูุฑุถ ุงุฌุงุฏ ูโุดูุฏ ู ูุดุฏุงุฑ ุฏุงุฏู ูโุดูุฏ ุงฺฏุฑ ูุงู ููุฌูุฏ ูุจุงุดุฏ). ูโุชูุงู ุงู ุฑุง ุงุถุงูู ฺฉุฑุฏ ุชุง requestูุง ูู ุฎูุฏฺฉุงุฑ ุณุงุฎุชู ุดููุฏ.
- ุซุจุช ุฎูุฏฺฉุงุฑ Policy ุง Route (ุดุงูู ุชุบุฑ ูุงูโูุง provider ุง route group) โ ูพฺุฏู ุงุณุช ู ุจูุชุฑ ูุจุงุดุฏ ฺฉู ุจุง ุชุงุฆุฏ ุชู ุงูุฌุงู ุฏูุฏ.
- ุชููุฏ DTOูุง/Result objects ููุฑุงู ุจุง action ุจุฑุง strict typing ู ุชุณุชโูพุฐุฑ ุจุงูุงุชุฑ.
- ุซุจุช ุฎูุฏฺฉุงุฑ ุชุณุช ฺฉุงููโุชุฑ (mocking repository) ุจูโุฌุง smoke-test ุณุงุฏู.

---

Developed by [Hadi HassanZadeh]  